const { join } = require('path');
const exec = require('./exec');
const fs = require('fs');

(async () => {
  console.log(
    `%c 
    ██╗  ██╗██╗██████╗ ██████╗ ██╗   ██╗     ██████╗  ██████╗ ██╗██╗     ███████╗██████╗ ██████╗ ██╗      █████╗ ████████╗███████╗
    ██║ ██╔╝██║██╔══██╗██╔══██╗╚██╗ ██╔╝     ██╔══██╗██╔═══██╗██║██║     ██╔════╝██╔══██╗██╔══██╗██║     ██╔══██╗╚══██╔══╝██╔════╝
    █████╔╝ ██║██████╔╝██████╔╝ ╚████╔╝█████╗██████╔╝██║   ██║██║██║     █████╗  ██████╔╝██████╔╝██║     ███████║   ██║   █████╗  
    ██╔═██╗ ██║██╔══██╗██╔══██╗  ╚██╔╝ ╚════╝██╔══██╗██║   ██║██║██║     ██╔══╝  ██╔══██╗██╔═══╝ ██║     ██╔══██║   ██║   ██╔══╝  
    ██║  ██╗██║██║  ██║██████╔╝   ██║        ██████╔╝╚██████╔╝██║███████╗███████╗██║  ██║██║     ███████╗██║  ██║   ██║   ███████╗
    ╚═╝  ╚═╝╚═╝╚═╝  ╚═╝╚═════╝    ╚═╝        ╚═════╝  ╚═════╝ ╚═╝╚══════╝╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚══════╝   
    `,
    'font-family:monospace',
  );
  await exec('yarn clear', { echo: true });
  await exec('yarn install', { echo: true });
  if (!fs.existsSync(join(__dirname, '/../.env'))) {
    await exec(`cp ${join(__dirname, '/../.env.example')} ${join(__dirname, '/../.env')}`, { echo: true });
  }
  await exec('yarn dev', { echo: true });
})();
